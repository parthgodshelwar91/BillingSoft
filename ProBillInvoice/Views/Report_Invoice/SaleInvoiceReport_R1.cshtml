@model RMCWeb.Models.SaleInvoiceModel

@{
    ViewBag.Title = "SaleInvoiceReport";
    int SrNo = 0;
    decimal cgstamt = 0;
    decimal sgstamt = 0;
    decimal igstamt = 0;
}


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <div class="row">
            <div class="col-xl-3">
                <div class="card">
                    <div class="card-header" style="padding: 13px 15px;">
                        <h5 class="card-title float-start mt-2" style="font-size:20px;">Sale Invoice</h5>
                        @*<a href="#" class="esti-new" title="New"><i class="las la-plus"></i> New</a>*@
                    </div>

                    <div class="card-body" style="padding: 0;">  
                        <div class="mx-n3">
                            <div data-simplebar data-simplebar-auto-hide="false" data-simplebar-track="secondary" style="max-height: 100%; height: 100vh;">
                                <div class="list-group list-group-flush zopage-right-panel">
                                    @foreach (var item in Model.InvoiceHeader)
                                    {
                                        <a href="@Url.Action("SaleInvoice_View", "Report_Invoice", new {InvoiceId = item.sale_invoice_id, PartyId = item.party_id })" class="list-group-item">
                                            <div class="fst-stage">
                                                <h5 class="partyname">@Html.DisplayFor(modelItem => item.party_name)</h5>
                                                <span class="partyvalueprice"><i class="las la-rupee-sign"></i> @String.Format("{0:N2}", item.total_amount)/-</span>
                                            </div>
                                            <div class="snd-stage">
                                                <span class="poiddate">@Html.DisplayFor(modelItem => item.invoice_no)</span><span class="podate">@string.Format("{0:dd/MM/yyyy}", item.invoice_date)</span>
                                            </div>
                                            <div class="thd-stage">
                                                <span class="grnno">@Html.DisplayFor(modelItem => item.company_name)</span><span class="grnvalue"><i></i> @string.Format("{0:dd/MM/yyyy}", item.invoice_date)</span>
                                            </div>
                                        </a>                                       
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-9">
                <div class="row">
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-6">
                                    <div class="zopage-header align-items-center">
                                        <h4>@Html.DisplayFor(model => model.InvoiceHeaderSearch.invoice_no)</h4>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="zopageclose"><a href="@Url.Action("Index","SaleInvoice")" title="Close"><i class="las la-window-close"></i></a></div>
                                    <div class="page-title-right">
                                        <ol class="breadcrumb m-0">
                                            <li class="breadcrumb-item"><a href="javascript: void(0);">Advance UI</a></li>
                                            <li class="breadcrumb-item active">Scrollbar</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>

                            <div class="row bg-light border-bottom border-top bg-opacity-25">
                                <div class="col-12">
                                    <div class="zopage-controler">
                                        <ul>
                                            <li><a href="@Url.Action("Edit","SaleInvoice",new { Id = Model.InvoiceHeaderSearch.sale_invoice_id})" class="breadcrumb-item"><i class="las la-edit"></i> Edit</a></li>
                                            <li><a href="#" class="breadcrumb-item"><i class="las la-envelope"></i> Sent</a></li>
                                            <li><a href="#" class="breadcrumb-item"><i class="las la-share-square"></i> Share</a></li>
                                            <li><a href="#" id="btnPrint" class="breadcrumb-item"><i class="las la-file-pdf"></i> PDF/Print</a></li>
                                            <li><a href="#" class="breadcrumb-item"><i class="las la-box"></i> Convert</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-9" style="width:100%; margin: 0 auto; overflow: auto; max-width: 820px;">
                        <div class="card">
                            <div style="width: 21cm !important; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                                <div id="printable">
                                    <div class="card-body pb-0" style="min-height: 700px; padding: 0px; font-size: 14px;">
                                        <div class="row p-4">
                                            <div class="col-12">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-12" style=" border-top:1px solid black; border-left:1px solid black; border-right:1px solid black ">
                                                            <div>
                                                                @Html.HiddenFor(model => model.InvoiceHeaderSearch.PartyId)
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="col-2" style="text-align:center;padding:10px">
                                                                    <img src="~/assets/images/rmcsoftware72.png" alt="RMC Software (Ready Mix Concrete)" title="Stamp" height="100">
                                                                </div>
                                                                <div class="col-6">
                                                                    <span style="font-size:22px; padding-top: 12px; text-align:left;">@Html.DisplayFor(model => model.Company.company_name)</span><br />
                                                                    <span>@Html.DisplayFor(model => model.Company.work_Address)</span><br />
                                                                    <span>@Html.DisplayFor(model => model.Company.work_Address2)</span><br />
                                                                    <div style="text-align: left;">
                                                                        @Html.Label("AT.POST :- ", new { @class = "col-form-label", @style = "padding: 0px;" })
                                                                        @Html.DisplayFor(model => Model.Company.city_name) @Html.DisplayFor(model => Model.Company.state_Name) @Html.DisplayFor(model => Model.Company.zip_code)  @Html.DisplayFor(model => Model.Company.country_name)
                                                                        <br />
                                                                        @Html.Label("GSTIN :-", htmlAttributes: new { @class = "col-form-label", @style = "padding: 0px;" })
                                                                        @Html.DisplayFor(model => Model.Company.gst_no, new { @class = "col-form-label", @style = "padding: 0px;" })
                                                                    </div>
                                                                </div>
                                                                <div class="col-4">
                                                                    <h5 class="card-title mb-0" style="font-size:28px; padding-top: 12px; margin-top:70px; text-align:right;">Sale Invoice</h5>
                                                                </div>
                                                            </div>

                                                            <div class="row" style="border-top:1px solid black ;">
                                                                <div class="col-6" style="padding-top:5px; padding-bottom:5px; border-right:1px solid black;">
                                                                    <div class="row">
                                                                        <div class="col-4">
                                                                            Invoice No :
                                                                        </div>
                                                                        <div class="col-8">
                                                                            <span style="font-weight:bold;">@Html.DisplayFor(model => model.InvoiceHeaderSearch.invoice_no)</span>
                                                                        </div>
                                                                    </div>

                                                                    <div class="row">
                                                                        <div class="col-4">
                                                                            Invoice Date :
                                                                        </div>
                                                                        <div class="col-8">
                                                                            @if (Model.InvoiceHeaderSearch != null)
                                                                            {
                                                                                <span style="font-weight:bold;">
                                                                                    @String.Format("{0:dd/MM/yyyy}", Model.InvoiceHeaderSearch.invoice_date)
                                                                                </span>
                                                                            }
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-6" style="padding-top:5px;">
                                                                    <div class="row">
                                                                        <div class="col-12">
                                                                            Place of Supply :  <span style="font-weight:bold;">@Html.DisplayFor(model => model.StateMst.state_name)</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="row">
                                                                <div class="col-6" style="border-right:1px solid black; padding-bottom: 10px;">
                                                                    <div class="row">
                                                                        <div class="col-12 bgrpt" style="border-top:1px solid black; border-bottom:1px solid black; font-weight: bold;">
                                                                            Bill To
                                                                        </div>
                                                                        <div class="col-12" style="padding-top:5px;">
                                                                            <span style="font-weight:bold;"> @Html.DisplayFor(model => model.partymaster.party_name)</span>
                                                                        </div>
                                                                        <div class="col-12">
                                                                            <span>@Html.DisplayFor(model => model.partymaster.billing_address)</span>
                                                                        </div>
                                                                        <div class="col-12">
                                                                            <span>@Html.DisplayFor(model => model.partymaster.city_name) @Html.DisplayFor(model => model.partymaster.pin_no) @Html.DisplayFor(model => model.partymaster.state_name)</span><br />
                                                                            <span>
                                                                                India @*Html.DisplayFor(model => model.PartyMasterSearch.country_id) *@
                                                                            </span><br />
                                                                        </div>
                                                                        <div class="col-12">
                                                                            GSTIN  <span>@Html.DisplayFor(model => model.partymaster.gst_no)</span>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="col-6" style="padding-bottom: 10px;">
                                                                    <div class="row">
                                                                        <div class="col-12" style="border-top:1px solid black; border-bottom:1px solid black; font-weight: bold;">
                                                                            Ship To
                                                                        </div>
                                                                        <div class="col-12" style="padding-top:5px;">
                                                                            <span style="font-weight:bold;">@Html.DisplayFor(model => model.partymaster.party_name)</span>
                                                                        </div>
                                                                        <div class="col-12">
                                                                            <span>@Html.DisplayFor(model => model.partymaster.delivery_address)</span>
                                                                        </div>
                                                                        <div class="col-12">
                                                                            <span>@Html.DisplayFor(model => model.partymaster.city_name) @Html.DisplayFor(model => model.partymaster.pin_no) @Html.DisplayFor(model => model.partymaster.state_name)</span><br />
                                                                            <span>India @*Html.DisplayFor(model => model.PartyMasterSearch.country_id)*@</span><br />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-12" style="min-height:0px; padding: 0px; font-size: 12px;">
                                                            <style>
                                                                .table_css th {
                                                                    padding: 5px 5px;
                                                                }

                                                                .table_css td {
                                                                    padding: 5px 5px;
                                                                }
                                                            </style>

                                                            <table id="Invoice" class="table table-bordered table-hover table_css" style="border: 1px; margin-bottom: 0px;">
                                                                <thead style="border: 1px;">
                                                                    <tr style="text-align: center;font-weight: bold;">
                                                                        <th rowspan="2">SN</th>
                                                                        <th rowspan="2">Item Name</th>
                                                                        <th rowspan="2">HSN Code</th>
                                                                        <th rowspan="2">Qty</th>
                                                                        <th rowspan="2">Rate</th>
                                                                        <th colspan="2">CGST</th>
                                                                        <th colspan="2">SGST</th>
                                                                        <th colspan="2">IGST</th>
                                                                        <th rowspan="2">Amount (Rs)</th>
                                                                    </tr>
                                                                    <tr style="text-align: center; font-weight: bold;">
                                                                        <th id="cgst">%</th>
                                                                        <th id="cgstamt">Amt</th>
                                                                        <th id="sgst">%</th>
                                                                        <th id="sgstamt">Amt</th>
                                                                        <th id="igst">%</th>
                                                                        <th id="igstamt">Amt</th>
                                                                    </tr>
                                                                </thead>

                                                                @if (Model.InvoiceDetails != null)
                                                                {
                                                                    foreach (var item in Model.InvoiceDetails)
                                                                    {
                                                                        SrNo = SrNo + 1;
                                                                        <tr style="font-size: 12px;">
                                                                            <td style="text-align:center; width: 3%;">@SrNo</td>
                                                                            <td style="width: 35%;">@Html.DisplayFor(x => item.material_name) <br /> @Html.DisplayFor(x => item.material_desc)</td>
                                                                            <td style="text-align:center; width: 5%;">@Html.DisplayFor(x => item.hsn_code)</td>
                                                                            <td style="text-align:right; width: 6%;">@Html.DisplayFor(x => item.item_qty) <br /> @Html.DisplayFor(x => item.short_desc)</td>
                                                                            <td style="text-align:right; width: 6%;">@Html.DisplayFor(x => item.item_rate)</td>
                                                                            <td style="text-align:right; width: 6%;">@Html.DisplayFor(x => item.cgst)</td>
                                                                            <td style="text-align:right; width: 6%; word-break:break-word;">@string.Format("{0:f2}", item.cgst_amt)</td>
                                                                            <td style="text-align:right; width: 6%;">@Html.DisplayFor(x => item.sgst)</td>
                                                                            <td style="text-align:right; width: 6%; word-break:break-word;">@string.Format("{0:f2}", item.sgst_amt)</td>
                                                                            <td style="text-align:right; width: 5%;">@Html.DisplayFor(x => item.igst)</td>
                                                                            <td style="text-align:right; width: 6%; word-break:break-word;">@string.Format("{0:f2}", item.igst_amt)</td>
                                                                            <td style="text-align:right; width: 10%;">@string.Format("{0:N2}", item.item_value)</td>
                                                                        </tr>

                                                                        cgstamt = cgstamt + item.cgst_amt;
                                                                        sgstamt = sgstamt + item.sgst_amt;
                                                                        igstamt = igstamt + item.igst_amt;
                                                                    }
                                                                }
                                                            </table>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-12" style=" border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black ">

                                                            <div class="row mb-1">
                                                                <div class="col-7" style="padding-top:10px;">
                                                                    <div class="row">
                                                                        <div class="col-12" style="padding-bottom: 10px;">
                                                                            Total In Words <br />
                                                                            <span style="font-weight: bold;">@Html.DisplayFor(model => model.InvoiceHeaderSearch.AmtInWord)</span>
                                                                        </div>
                                                                    </div>

                                                                    <div class="row">
                                                                        <div class="col-12" style="margin-top:0px; font-size: 12px;">
                                                                            Notes :-<br />
                                                                            <span># Time of delivery: 7 week(Time Line starts from the receiving 100% advance Payment)</span><br />
                                                                            <span># Frieght: To Pay, #Dispatch, By Road, #Packing: included.</span><br />
                                                                            <span># Destination : Ex- Factory, # Mode/Terms Of Payment-Advance: 100% against PO, #Traveling/FOOD/Expense: at you side</span>
                                                                        </div>
                                                                    </div>

                                                                    <div class="row">
                                                                        <div class="col-12" style="margin-top:10px; font-size: 12px;">
                                                                            Bank Name : <span>@Html.DisplayFor(model => Model.Company.branch_bank_name)</span><br />
                                                                            Branch : <span>@Html.DisplayFor(model => Model.Company.branch_name)</span><br />
                                                                            IFSC Code : <span>@Html.DisplayFor(model => Model.Company.IFSC)</span><br />
                                                                            AC No : <span>@Html.DisplayFor(model => Model.Company.bank_ac_no)</span><br />
                                                                            Swift Code : <span>@Html.DisplayFor(model => Model.Company.MICR)</span><br />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-5">
                                                                    <div class="row">
                                                                        <div class="col-12" style="border-left:1px solid black">
                                                                            @if (cgstamt != 0)
                                                                            {
                                                                                <div class="row">
                                                                                    <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                                        Cgst(%)
                                                                                    </div>

                                                                                    <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                                        @String.Format("{0:N2}", cgstamt)
                                                                                    </div>
                                                                                </div>
                                                                            }
                                                                            @if (sgstamt != 0)
                                                                            {
                                                                                <div class="row">
                                                                                    <div class="col-6" style="text-align: right;">
                                                                                        Sgst(%)
                                                                                    </div>

                                                                                    <div class="col-6" style="text-align: right;">
                                                                                        @String.Format("{0:N2}", sgstamt)
                                                                                    </div>
                                                                                </div>
                                                                            }
                                                                            @if (igstamt != 0)
                                                                            {
                                                                                <div class="row">
                                                                                    <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                                        Igst(%)
                                                                                    </div>

                                                                                    <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                                        @String.Format("{0:N2}", igstamt)
                                                                                    </div>
                                                                                </div>
                                                                            }

                                                                            <div class="row">
                                                                                <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                                    Sub Total
                                                                                </div>
                                                                                <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                                    @if (Model.InvoiceHeaderSearch != null)
                                                                                    {
                                                                                        @String.Format("{0:N2}", Model.InvoiceHeaderSearch.basic_amount)
                                                                                    }
                                                                                </div>
                                                                            </div>

                                                                            <div class="row">
                                                                                @if (Model.InvoiceTax != null)
                                                                                {
                                                                                    foreach (var item in Model.InvoiceTax)
                                                                                    {
                                                                                        <div class="col-6" style="text-align:right;">
                                                                                            @Html.DisplayFor(x => item.account_name)
                                                                                        </div>
                                                                                        <div class="col-6">
                                                                                            <div style="text-align:right;">@String.Format("{0:N2}", item.amount)</div>
                                                                                        </div>
                                                                                    }
                                                                                }
                                                                            </div>

                                                                            <div class="row" style="border-top:1px solid black;">
                                                                                <div class="col-6" style="text-align: right; font-weight: bold;">
                                                                                    Total
                                                                                </div>

                                                                                <div class="col-6" style="text-align: right; font-weight: bold;">
                                                                                    @if (Model.InvoiceHeaderSearch != null)
                                                                                    {
                                                                                        @String.Format("{0:N2}", Model.InvoiceHeaderSearch.total_amount)
                                                                                    }
                                                                                </div>
                                                                            </div>

                                                                            <div class="row" style="border-top:1px solid black; border-bottom:1px solid black;">
                                                                                <div class="col-12" style="margin-top:20px; text-align: center;">
                                                                                    <span style="font-weight: bold;">For :- @Html.DisplayFor(model => Model.Company.company_name)</span>
                                                                                    <br />
                                                                                    <img src="~/assets/images/Stamp.png" alt="Stamp" title="Stamp" height="90">
                                                                                    <br /><br />
                                                                                    Authorised Signature
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="row mb-1">
                                                                <div class="col-12" style="margin-top:10px;">
                                                                    Terms and Conditions :-<br />
                                                                    @*<span style="font-size: 12px;">Declaration: We declare that the invoce shows the actual price of goods described and that all perticuler are true. Order once placed cannot be cancelled. Subject to Nagpur jurisdictiion only.</span><br />*@
                                                                  <span style="font-size: 12px;">Declaration: @Model.TermsCondition.terms_conditions</span><br />

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval") 

    <script>
        $("#InvoiceHeaderSearch_PartyId").change(function () {
            var PartyId = parseInt($(this).val());
            if (PartyId > 0) {
                $.ajax({
                    url: '/Report_Invoice/InvoicePartyWise',
                    type: 'POST',
                    dataType: 'json',
                    data: { PartyId: PartyId },
                    success: function (data) {
                        var items = '';

                        var items = "<option>---Select---</option>";
                        $.each(data, function (i, order) {
                            items += "<option value='" + order.Value + "'>" + order.Text + "</option>";
                        });
                        $('#InvoiceHeaderSearch_sale_invoice_id').html(items);

                    },
                    error: function () {
                        alert('Error!');
                    }
                });
            }
        });
    </script>


    <script>
        function AjFunction(GSTStatus) {
            if (GSTStatus === "Within State Customer") {
                $('#Invoice tr th[colspan]:nth-child(6)').show();
                $('#Invoice tr th[id="cgst"]:nth-child(1)').show();
                $('#Invoice tr th[ id="cgstamt"]:nth-child(2)').show();
                $('#Invoice td:nth-child(6)').show();
                $('#Invoice td:nth-child(7)').show();

                $('#Invoice tr th[colspan]:nth-child(7)').show();
                $('#Invoice tr th[id="sgst"]:nth-child(3)').show();
                $('#Invoice tr th[ id="sgstamt"]:nth-child(4)').show();
                $('#Invoice td:nth-child(8)').show();
                $('#Invoice td:nth-child(9)').show();

                $('#Invoice tr th[colspan]:nth-child(8)').hide();
                $('#Invoice tr th[id="igst"]:nth-child(5)').hide();
                $('#Invoice tr th[ id="igstamt"]:nth-child(6)').hide();
                $('#Invoice td:nth-child(10)').hide();
                $('#Invoice td:nth-child(11)').hide();

            } else if (GSTStatus === "Out of State Customer") {
                $('#Invoice tr th[colspan]:nth-child(6)').hide();
                $('#Invoice tr th[id="cgst"]:nth-child(1)').hide();
                $('#Invoice tr th[ id="cgstamt"]:nth-child(2)').hide();
                $('#Invoice td:nth-child(6)').hide();
                $('#Invoice td:nth-child(7)').hide();
                $('#Invoice tr th[colspan]:nth-child(7)').hide();
                $('#Invoice tr th[id="sgst"]:nth-child(3)').hide();
                $('#Invoice tr th[ id="sgstamt"]:nth-child(4)').hide();
                $('#Invoice td:nth-child(8)').hide();
                $('#Invoice td:nth-child(9)').hide();
                $('#Invoice tr th[colspan]:nth-child(8)').show();
                $('#Invoice tr th[id="igst"]:nth-child(5)').show();
                $('#Invoice tr th[ id="igstamt"]:nth-child(6)').show();
                $('#Invoice td:nth-child(10)').show();
                $('#Invoice td:nth-child(11)').show();
            }
        }

        $(document).ready(function () {
            $("#InvoiceHeaderSearch_PartyId").change(function () {
                //var selectedText = $(this).find("option:selected").text();
                var selectedValue = $(this).val();

                var lsParameter = {
                    PartyId: selectedValue,
                    PartyName: " "
                };
                $.ajax({
                    type: "POST",
                    url: "/SaleInvoice/PartyDetail",
                    data: JSON.stringify(lsParameter),
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        PartyCode = data.msg.split("|")[0];
                        PartyAddress = data.msg.split("|")[1];
                        GSTStatus = data.msg.split("|")[2];
                        //$('#lblPartyCode').text(PartyCode);
                        //$('#lblPartyAddress').text(PartyAddress);
                        //$('#lblGSTStatus').text(GSTStatus);
                        AjFunction(GSTStatus); // Call the AjFunction with GSTStatus
                    },
                    error: function () {
                        alert("Error occured!!")
                    }
                });
            })
        })

        $(document).ready(function () {
            //debugger;
            //var selectedText = $("#InvoiceHeaderSearch_party_id").find("option:selected").text();
            var selectedValue = $("#InvoiceHeaderSearch_PartyId").val();

            var lsParameter = {
                PartyId: selectedValue,
                PartyName: " "
            };
            $.ajax({
                type: "POST",
                url: "/SaleInvoice/PartyDetail",
                data: JSON.stringify(lsParameter),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    PartyCode = data.msg.split("|")[0];
                    PartyAddress = data.msg.split("|")[1];
                    GSTStatus = data.msg.split("|")[2];
                    //$('#lblPartyCode').text(PartyCode);
                    //$('#lblPartyAddress').text(PartyAddress);
                    //$('#lblGSTStatus').text(GSTStatus);
                    AjFunction(GSTStatus); // Call the AjFunction with GSTStatus
                },
                error: function () {

                }
            });
        })
    </script>
}


@*<div class="form-horizontal">
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    <div class="row">
        <div class="col-sm-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-6">
                            <h5 class="card-title mb-0" style="font-size: 24px; padding-top: 5px;">Sale Invoice  Report</h5>
                        </div>
                        <div class="col-sm-6" style="text-align: right;">

                            <div class="form-group">
                                <div class="hstack gap-2 justify-content-end d-print-none mb-0">
                                    <a href="@Url.Action("Edit","SaleInvoice",new { Id = Model.InvoiceHeaderSearch.sale_invoice_id})" class="btn btn-primary"><i class="ri-pencil-fill align-bottom"></i> Edit</a>
                                    @*<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModalgrid"><i class="ri-user-smile-line label-icon align-middle fs-16 me-2"></i>Open</button>*
                                    <a class="btn btn-info" href="#" id="btnPrint" data-abc="true"><i class="ri-printer-line align-bottom me-1"></i>Print</a>
                                    <button type="submit" id="btnDownload" formaction="InvoiceSearch_ExportToExcel" formmethod="post" class="btn btn-primary"><i class="ri-file-excel-2-fill fs-16 me-2"></i>Excel</button>
                                    <button type="submit" id="btnDownloadPDF" formaction="InvoiceSearch_ExportToPDF" formmethod="post" class="btn btn-primary"><i class="ri-file-pdf-line" style="padding:2px 6px 0 0;"></i>PDF</button>
                                    <a href="@Url.Action("Index","SaleInvoice")" class="cancel-btn-normal"><i class="ri-close-fill"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-3">
            <div class="card">
                <div class="card-body">
                    <style>
                        .d-flex {
                            display: -ms-flexbox !important;
                            display: flex !important;
                        }

                        .flex-fill {
                            border-bottom: #ddd solid 1px;
                            padding: 7px 0;
                        }
                    </style>

                    @foreach (var item in Model.InvoiceHeader)
                    {
                        <div class="d-flex">
                            <a href="@Url.Action("SaleInvoice_View", "Report_Invoice", new {InvoiceId = item.sale_invoice_id, PartyId = item.party_id })">
                                <div class="flex-fill" style="width:400px;">
                                    <div class="text-black">
                                        <span>@Html.DisplayFor(modelItem => item.party_name)</span>
                                        <span style="float:right;">Rs. @String.Format("{0:N2}", item.total_amount)/-</span>
                                    </div>
                                    <span class="text-primary">@Html.DisplayFor(modelItem => item.invoice_no)</span>
                                    <span class="opacity-50" style="float:right;">@string.Format("{0:dd/MM/yyyy}", item.invoice_date)</span>
                                    <div>
                                        <span class="opacity-50">@Html.DisplayFor(modelItem => item.invoice_type)</span>
                                        <span class="text-indigo" style="float:right;">Rs. @String.Format("{0:N2}", item.total_amount)/-</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
        <div class="col-9" style="width:100%; margin: 0 auto; max-width: 900px;">
            <div class="card">
                <div id="printable">
                    <div class="card-body pb-0" style="min-height: 700px; padding: 0px; font-size: 14px;">
                        <div class="row p-4">
                            <div class="col-12">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-12" style=" border-top:1px solid black; border-left:1px solid black; border-right:1px solid black ">
                                            <div>
                                                @Html.HiddenFor(model => model.InvoiceHeaderSearch.PartyId)
                                            </div>
                                            <div class="row mb-1">
                                                <div class="col-2" style="text-align:center;padding:10px">
                                                    <img src="~/assets/images/rmcsoftware72.png" alt="RMC Software (Ready Mix Concrete)" title="Stamp" height="70">
                                                </div>
                                                <div class="col-6">
                                                    <span style="font-size:22px; padding-top: 12px; text-align:left;">@Html.DisplayFor(model => model.Company.company_name)</span><br />
                                                    <span>@Html.DisplayFor(model => model.Company.billing_address)</span><br />
                                                    <span>@Html.DisplayFor(model => model.Company.billing_address2)</span><br />
                                                    <div style="text-align: left;">
                                                        @Html.Label("AT.POST :- ", new { @class = "col-form-label", @style = "padding: 0px;" })
                                                        @Html.DisplayFor(model => Model.Company.city_name) @Html.DisplayFor(model => Model.Company.state_Name) @Html.DisplayFor(model => Model.Company.zip_code)  @Html.DisplayFor(model => Model.Company.country_name)
                                                        <br />
                                                        @Html.Label("GSTIN :-", htmlAttributes: new { @class = "col-form-label", @style = "padding: 0px;" })
                                                        @Html.DisplayFor(model => Model.Company.gst_no, new { @class = "col-form-label", @style = "padding: 0px;" })
                                                    </div>
                                                </div>
                                                <div class="col-4">
                                                    <h5 class="card-title mb-0" style="font-size:28px; padding-top: 12px; margin-top:70px; text-align:right;">Sale Invoice</h5>
                                                </div>
                                            </div>

                                            <div class="row" style="border-top:1px solid black ;">
                                                <div class="col-6" style="padding-top:5px; padding-bottom:5px; border-right:1px solid black;">
                                                    <div class="row">
                                                        <div class="col-4">
                                                            Invoice No :
                                                        </div>
                                                        <div class="col-8">
                                                            <span style="font-weight:bold;">@Html.DisplayFor(model => model.InvoiceHeaderSearch.invoice_no)</span>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-4">
                                                            Invoice Date :
                                                        </div>
                                                        <div class="col-8">
                                                            @if (Model.InvoiceHeaderSearch != null)
                                                            {
                                                                <span style="font-weight:bold;">
                                                                    @String.Format("{0:dd/MM/yyyy}", Model.InvoiceHeaderSearch.invoice_date)
                                                                </span>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-6" style="padding-top:5px;">
                                                    <div class="row">
                                                        <div class="col-12">
                                                            Place of Supply :  <span style="font-weight:bold;">@Html.DisplayFor(model => model.StateMst.state_name)</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-6" style="border-right:1px solid black; padding-bottom: 10px;">
                                                    <div class="row">
                                                        <div class="col-12 bgrpt" style="border-top:1px solid black; border-bottom:1px solid black; font-weight: bold;">
                                                            Bill To
                                                        </div>
                                                        <div class="col-12" style="padding-top:5px;">
                                                            <span style="font-weight:bold;"> @Html.DisplayFor(model => model.InvoiceHeaderSearch.party_name)</span>
                                                        </div>
                                                        <div class="col-12">
                                                            <span>@Html.DisplayFor(model => model.partymaster.billing_address)</span>
                                                        </div>
                                                        <div class="col-12">
                                                            <span>@Html.DisplayFor(model => model.partymaster.city_name) @Html.DisplayFor(model => model.partymaster.pin_no) @Html.DisplayFor(model => model.partymaster.state_name)</span><br />
                                                            <span>India @@Html.DisplayFor(model => model.PartyMasterSearch.country_id)@</span><br />
                                                        </div>
                                                        <div class="col-12">
                                                            GSTIN  <span>@Html.DisplayFor(model => model.partymaster.gst_no)</span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-6" style="padding-bottom: 10px;">
                                                    <div class="row">
                                                        <div class="col-12" style="border-top:1px solid black; border-bottom:1px solid black; font-weight: bold;">
                                                            Ship To
                                                        </div>
                                                        <div class="col-12" style="padding-top:5px;">
                                                            <span style="font-weight:bold;">@Html.DisplayFor(model => model.partymaster.party_name)</span>
                                                        </div>
                                                        <div class="col-12">
                                                            <span>@Html.DisplayFor(model => model.partymaster.delivery_address)</span>
                                                        </div>
                                                        <div class="col-12">
                                                            <span>@Html.DisplayFor(model => model.partymaster.city_name) @Html.DisplayFor(model => model.partymaster.pin_no) @Html.DisplayFor(model => model.partymaster.state_name)</span><br />
                                                            <span>India @@Html.DisplayFor(model => model.PartyMasterSearch.country_id)@</span><br />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12" style="min-height:0px; padding: 0px; font-size: 12px;">
                                            <style>
                                                .table_css th {
                                                    padding: 5px 5px;
                                                }

                                                .table_css td {
                                                    padding: 5px 5px;
                                                }
                                            </style>

                                            <table id="Invoice" class="table table-bordered table-hover table_css" style="border: 1px; margin-bottom: 0px;">
                                                <thead style="border: 1px;">
                                                    <tr style="text-align: center;font-weight: bold;">
                                                        <th rowspan="2">SN</th>
                                                        <th rowspan="2">Item Name</th>
                                                        <th rowspan="2">HSN Code</th>
                                                        <th rowspan="2">Qty</th>
                                                        <th rowspan="2">Rate</th>
                                                        <th colspan="2">CGST</th>
                                                        <th colspan="2">SGST</th>
                                                        <th colspan="2">IGST</th>
                                                        <th rowspan="2">Amount (Rs)</th>
                                                    </tr>
                                                    <tr style="text-align: center; font-weight: bold;">
                                                        <th id="cgst">%</th>
                                                        <th id="cgstamt">Amt</th>
                                                        <th id="sgst">%</th>
                                                        <th id="sgstamt">Amt</th>
                                                        <th id="igst">%</th>
                                                        <th id="igstamt">Amt</th>
                                                    </tr>
                                                </thead>

                                                @if (Model.InvoiceDetails != null)
                                                {
                                                    foreach (var item in Model.InvoiceDetails)
                                                    {
                                                        SrNo = SrNo + 1;
                                                        <tr style="font-size: 12px;">
                                                            <td style="text-align:center; width: 3%;">@SrNo</td>
                                                            <td style="width: 40%;">@Html.DisplayFor(x => item.material_name) <br /> @Html.DisplayFor(x => item.material_desc)</td>
                                                            <td style=" text-align:center; width: 5%;">@Html.DisplayFor(x => item.hsn_code)</td>
                                                            <td style="text-align:right; width: 6%;">@Html.DisplayFor(x => item.item_qty) <br />@Html.DisplayFor(x => item.short_desc)</td>
                                                            <td style="text-align:right; width: 6%;">@Html.DisplayFor(x => item.item_rate)</td>
                                                            <td style="text-align:right; width: 5%;">@Html.DisplayFor(x => item.cgst)</td>
                                                            <td style="text-align:right; width: 5%; word-break:break-word;">@string.Format("{0:f2}", item.cgst_amt)</td>
                                                            <td style="text-align:right; width: 5%;">@Html.DisplayFor(x => item.sgst)</td>
                                                            <td style="text-align:right; width: 5%; word-break:break-word;">@string.Format("{0:f2}", item.sgst_amt)</td>
                                                            <td style="text-align:right; width: 5%;">@Html.DisplayFor(x => item.igst)</td>
                                                            <td style="text-align:right; width: 10%; word-break:break-word;">@string.Format("{0:f2}", item.igst_amt)</td>
                                                            <td style="text-align:right; width: 10%;">@string.Format("{0:N2}", item.item_value)</td>
                                                        </tr>

                                                        cgstamt = cgstamt + item.cgst_amt;
                                                        sgstamt = sgstamt + item.sgst_amt;
                                                        igstamt = igstamt + item.igst_amt;
                                                    }
                                                }
                                            </table>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12" style=" border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black ">

                                            <div class="row">
                                                <div class="col-7" style="padding-top:10px;">
                                                    <div class="row">
                                                        <div class="col-12" style="padding-bottom: 10px;">
                                                            Total In Words <br />
                                                            <span style="font-weight: bold;">@Html.DisplayFor(model => model.InvoiceHeaderSearch.AmtInWord)</span>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-12" style="margin-top:0px;">
                                                            Notes :-<br />
                                                            <span># Time of delivery: 7 week(Time Line starts from the receiving 100% advance Payment)</span><br />
                                                            <span># Frieght: To Pay, #Dispatch, By Road, #Packing: included.</span><br />
                                                            <span># Destination : Ex- Factory, # Mode/Terms Of Payment-Advance: 100% against PO, #Traveling/FOOD/Expense: at you side</span>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-12" style="margin-top:10px;">
                                                            Bank Name : <span>@Html.DisplayFor(model => Model.Company.branch_bank_name)</span><br />
                                                            Branch : <span>@Html.DisplayFor(model => Model.Company.branch_name)</span><br />
                                                            IFSC Code : <span>@Html.DisplayFor(model => Model.Company.IFSC)</span><br />
                                                            AC No : <span>@Html.DisplayFor(model => Model.Company.bank_ac_no)</span><br />
                                                            Swift Code : <span>@Html.DisplayFor(model => Model.Company.MICR)</span><br />
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-12" style="margin-top:10px;">
                                                            Terms and Conditions :-<br />
                                                            <span style="font-size: 12px;">Declaration: We declare that the invoce shows the actual price of goods described and that all perticuler are true. Order once placed cannot be cancelled. Subject to Nagpur jurisdictiion only.</span><br />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-5">
                                                    <div class="row">
                                                        <div class="col-12" style="border-left:1px solid black">
                                                            @if (cgstamt != 0)
                                                            {
                                                                <div class="row">
                                                                    <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                        Cgst(%)
                                                                    </div>

                                                                    <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                        @String.Format("{0:N2}", cgstamt)
                                                                    </div>
                                                                </div>
                                                            }
                                                            @if (sgstamt != 0)
                                                            {
                                                                <div class="row">
                                                                    <div class="col-6" style="text-align: right;">
                                                                        Sgst(%)
                                                                    </div>

                                                                    <div class="col-6" style="text-align: right;">
                                                                        @String.Format("{0:N2}", sgstamt)
                                                                    </div>
                                                                </div>
                                                            }
                                                            @if (igstamt != 0)
                                                            {
                                                                <div class="row">
                                                                    <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                        Igst(%)
                                                                    </div>

                                                                    <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                        @String.Format("{0:N2}", igstamt)
                                                                    </div>
                                                                </div>
                                                            }

                                                            <div class="row">
                                                                <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                    Sub Total
                                                                </div>
                                                                <div class="col-6" style="text-align: right; padding-top: 10px;">
                                                                    @if (Model.InvoiceHeaderSearch != null)
                                                                    {
                                                                        @String.Format("{0:N2}", Model.InvoiceHeaderSearch.basic_amount)
                                                                    }
                                                                </div>
                                                            </div>

                                                            <div class="row">
                                                                @if (Model.InvoiceTax != null)
                                                                {
                                                                    foreach (var item in Model.InvoiceTax)
                                                                    {
                                                                        <div class="col-6" style="text-align:right;">
                                                                            @Html.DisplayFor(x => item.account_name)
                                                                        </div>
                                                                        <div class="col-6">
                                                                            <div style="text-align:right;">@String.Format("{0:N2}", item.amount)</div>
                                                                        </div>
                                                                    }
                                                                }
                                                            </div>

                                                            <div class="row" style="border-top:1px solid black;">
                                                                <div class="col-6" style="text-align: right; font-weight: bold;">
                                                                    Total
                                                                </div>

                                                                <div class="col-6" style="text-align: right; font-weight: bold;">
                                                                    @if (Model.InvoiceHeaderSearch != null)
                                                                    {
                                                                        @String.Format("{0:N2}", Model.InvoiceHeaderSearch.total_amount)
                                                                    }
                                                                </div>
                                                            </div>

                                                            <div class="row" style="border-top:1px solid black; border-bottom:1px solid black;">
                                                                <div class="col-12" style="margin-top:20px; text-align: center;">
                                                                    <span style="font-weight: bold;">For :- @Html.DisplayFor(model => Model.Company.company_name)</span>
                                                                    <br />
                                                                    <img src="~/assets/images/Stamp.png" alt="Stamp" title="Stamp" height="90">
                                                                    <br /><br />
                                                                    Authorised Signature
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>*@

